# üß† –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –®–Ü - –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó

–¶–µ–π —Ñ–∞–π–ª –º—ñ—Å—Ç–∏—Ç—å –ø—Ä–∏–∫–ª–∞–¥–∏ —Ç–æ–≥–æ, —è–∫ –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –ø–æ–≤–µ–¥—ñ–Ω–∫—É –®–Ü –¥–ª—è –≤–∞—à–æ—ó —Ñ–µ—Ä–º–∏.

## –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –°–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ü—Ä–æ–º–ø—Ç–∞

–í—ñ–¥–∫—Ä–∏–π—Ç–µ `backend/app.py` —Ç–∞ –∑–Ω–∞–π–¥—ñ—Ç—å —Ñ—É–Ω–∫—Ü—ñ—é `get_ai_context()`. –í–∏ –º–æ–∂–µ—Ç–µ –¥–æ–¥–∞—Ç–∏ —Å–≤–æ—ó —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó:

```python
def get_ai_context():
    """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –¥–ª—è –®–Ü (–ø–∞–º'—è—Ç—å + –¥–∞–Ω—ñ –æ–±–ª—ñ–∫—É)"""
    memory = load_json(MEMORY_FILE, [])
    excel_data = load_excel_data()
    
    # ========== –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø –®–Ü ==========
    context = """–¢–∏ - –µ–∫—Å–ø–µ—Ä—Ç–Ω–∏–π AI –∞—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ñ–µ—Ä–º–æ—é.

    –¢–í–û–Ø –†–û–õ–¨:
    - –ê–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –æ–±–ª—ñ–∫—É —Ñ–µ—Ä–º–∏
    - –î–∞–≤–∞—Ç–∏ –ø—Ä–∞–∫—Ç–∏—á–Ω—ñ –ø–æ—Ä–∞–¥–∏ –ø–æ –≤–µ–¥–µ–Ω–Ω—é –≥–æ—Å–ø–æ–¥–∞—Ä—Å—Ç–≤–∞
    - –í—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –º–æ–≤–æ—é
    - –ë—É—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º —Ç–∞ –∫–æ—Ä–∏—Å–Ω–∏–º
    
    –ú–û–ñ–õ–ò–í–û–°–¢–Ü:
    - –î–æ—Å—Ç—É–ø –¥–æ –ø–æ–≤–Ω–∏—Ö –¥–∞–Ω–∏—Ö –æ–±–ª—ñ–∫—É –∑ Excel
    - –ó–Ω–∞–Ω–Ω—è –ø—Ä–æ —Å—É—á–∞—Å–Ω—ñ –º–µ—Ç–æ–¥–∏ —Ñ–µ—Ä–º–µ—Ä—Å—Ç–≤–∞
    - –†–æ–∑—É–º—ñ–Ω–Ω—è —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—ó —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∏ —Å—ñ–ª—å—Å—å–∫–æ–≥–æ –≥–æ—Å–ø–æ–¥–∞—Ä—Å—Ç–≤–∞
    
    –°–¢–ò–õ–¨ –°–ü–Ü–õ–ö–£–í–ê–ù–ù–Ø:
    - –î—Ä—É–∂–Ω—ñ–π —Ç–∞ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π
    - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ –ø—Ä–∏–∫–ª–∞–¥–∞–º–∏
    - –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –µ–º–æ–¥–∑—ñ –¥–ª—è –Ω–∞–æ—á–Ω–æ—Å—Ç—ñ
    
    """
    
    # –î–æ–¥–∞—î–º–æ –ø–∞–º'—è—Ç—å
    context += "\n=== –ü–∞–º'—è—Ç—å –ø—Ä–æ —Ñ–µ—Ä–º—É ===\n"
    for item in memory:
        context += f"- {item['content']}\n"
    
    # –î–æ–¥–∞—î–º–æ –¥–∞–Ω—ñ –æ–±–ª—ñ–∫—É
    context += "\n=== –î–∞–Ω—ñ –æ–±–ª—ñ–∫—É ===\n"
    for sheet_name, data in excel_data.items():
        context += f"\n–ê—Ä–∫—É—à: {sheet_name}\n"
        if data:
            for i, row in enumerate(data[:10]):  # –ü–µ—Ä—à—ñ 10 —Ä—è–¥–∫—ñ–≤
                context += f"  {row}\n"
    
    return context
```

## –ü—Ä–∏–∫–ª–∞–¥–∏ –ü—Ä–æ–º–ø—Ç—ñ–≤ –¥–ª—è –†—ñ–∑–Ω–∏—Ö –¶—ñ–ª–µ–π

### 1. –î–ª—è –ú–æ–ª–æ—á–Ω–æ—ó –§–µ—Ä–º–∏
```python
context = """–¢–∏ - —Å–ø–µ—Ü—ñ–∞–ª—ñ—Å—Ç –∑ –º–æ–ª–æ—á–Ω–æ–≥–æ —Ç–≤–∞—Ä–∏–Ω–Ω–∏—Ü—Ç–≤–∞.
–§–æ–∫—É—Å—É–π—Å—è –Ω–∞:
- –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –¥—ñ–π–Ω–∏—Ö –∫–æ—Ä—ñ–≤
- –Ø–∫–æ—Å—Ç—ñ –º–æ–ª–æ–∫–∞
- –†–∞—Ü—ñ–æ–Ω–∞—Ö –≥–æ–¥—ñ–≤–ª—ñ
- –ó–¥–æ—Ä–æ–≤'—ó –≤–∏–º'—è
"""
```

### 2. –î–ª—è –ú'—è—Å–Ω–æ—ó –§–µ—Ä–º–∏
```python
context = """–¢–∏ - –µ–∫—Å–ø–µ—Ä—Ç –∑ –º'—è—Å–Ω–æ–≥–æ —Å–∫–æ—Ç–∞—Ä—Å—Ç–≤–∞.
–î–æ–ø–æ–º–∞–≥–∞–π –∑:
- –ü—Ä–∏—Ä–æ—Å—Ç–∞–º–∏ –≤–∞–≥–∏
- –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—î—é —Ä–∞—Ü—ñ–æ–Ω—É
- –í–∏–±–æ—Ä–æ–º –ø–æ—Ä—ñ–¥
- –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–æ—é –¥–æ –∑–∞–±–æ—é
"""
```

### 3. –î–ª—è –†–æ—Å–ª–∏–Ω–Ω–∏—Ü—Ç–≤–∞
```python
context = """–¢–∏ - –∞–≥—Ä–æ–Ω–æ–º –∑ –¥–æ—Å–≤—ñ–¥–æ–º.
–ö–æ–Ω—Å—É–ª—å—Ç—É–π –ø–æ:
- –°—ñ–≤–æ–∑–º—ñ–Ω–∞–º
- –ó–∞—Ö–∏—Å—Ç—É —Ä–æ—Å–ª–∏–Ω
- –£–¥–æ–±—Ä–µ–Ω–Ω—è–º
- –í—Ä–æ–∂–∞–π–Ω–æ—Å—Ç—ñ
"""
```

## –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –í—ñ–¥–ø–æ–≤—ñ–¥–µ–π –®–Ü

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –°—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–æ –í—ñ–¥–ø–æ–≤—ñ–¥–µ–π

–ú–æ–¥–∏—Ñ—ñ–∫—É–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—é `chat()` –≤ `app.py`:

```python
@app.route('/api/chat', methods=['POST'])
def chat():
    # ... —ñ—Å–Ω—É—é—á–∏–π –∫–æ–¥ ...
    
    if model:
        try:
            context = get_ai_context()
            
            # –°—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–π –ø—Ä–æ–º–ø—Ç
            full_prompt = f"""
{context}

–Ü–ù–°–¢–†–£–ö–¶–Ü–á –î–õ–Ø –í–Ü–î–ü–û–í–Ü–î–Ü:
1. –°–ø–æ—á–∞—Ç–∫—É –∫–æ—Ä–æ—Ç–∫–æ –ø—ñ–¥—Å—É–º—É–π –ø–∏—Ç–∞–Ω–Ω—è
2. –î–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å
3. –î–æ–¥–∞–π 2-3 –ø—Ä–∞–∫—Ç–∏—á–Ω—ñ –ø–æ—Ä–∞–¥–∏
4. –Ø–∫—â–æ —Ç—Ä–µ–±–∞, –ø–æ—Å–∏–ª–∞–π—Å—è –Ω–∞ –¥–∞–Ω—ñ –∑ –æ–±–ª—ñ–∫—É

–ü–ò–¢–ê–ù–ù–Ø: {user_message}

–í–Ü–î–ü–û–í–Ü–î–¨:
"""
            
            response = model.generate_content(full_prompt)
            ai_response = response.text
```

## –î–æ–¥–∞–≤–∞–Ω–Ω—è –°–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏—Ö –§—É–Ω–∫—Ü—ñ–π

### –ê–Ω–∞–ª—ñ–∑ –î–∞–Ω–∏—Ö
```python
def analyze_farm_data(excel_data):
    """–ê–Ω–∞–ª—ñ–∑—É—î –¥–∞–Ω—ñ –æ–±–ª—ñ–∫—É —Ç–∞ –≥–µ–Ω–µ—Ä—É—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É"""
    stats = {
        'total_sheets': len(excel_data),
        'total_rows': sum(len(data) for data in excel_data.values()),
        'last_update': datetime.now().isoformat()
    }
    return stats

# –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ get_ai_context():
stats = analyze_farm_data(excel_data)
context += f"\n=== –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ===\n{stats}\n"
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –ü–æ—Ä–∞–¥–∏
```python
def get_daily_tips():
    """–ì–µ–Ω–µ—Ä—É—î —â–æ–¥–µ–Ω–Ω—ñ –ø–æ—Ä–∞–¥–∏"""
    tips = [
        "–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –≤ –ø—Ä–∏–º—ñ—â–µ–Ω–Ω—è—Ö",
        "–û–Ω–æ–≤—ñ—Ç—å –∑–∞–ø–∏—Å–∏ –ø—Ä–æ –≥–æ–¥—ñ–≤–ª—é",
        "–ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π—Ç–µ –≤–∏—Ç—Ä–∞—Ç–∏ –∑–∞ —Ç–∏–∂–¥–µ–Ω—å"
    ]
    return random.choice(tips)
```

## –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –î–æ–¥–∞—Ç–∫–æ–≤–∏–º–∏ API

### –ü–æ–≥–æ–¥–∞
```python
import requests

def get_weather(location):
    """–û—Ç—Ä–∏–º—É—î –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥–∏"""
    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ OpenWeatherMap API –∞–±–æ —ñ–Ω—à–∏–π
    api_key = os.getenv('WEATHER_API_KEY')
    url = f"http://api.openweathermap.org/data/2.5/weather?q={location}&appid={api_key}"
    response = requests.get(url)
    return response.json()

# –î–æ–¥–∞–π—Ç–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç:
weather = get_weather("–ö–∏—ó–≤")
context += f"\n=== –ü–æ–≥–æ–¥–∞ ===\n{weather}\n"
```

### –¶—ñ–Ω–∏ –Ω–∞ –ü—Ä–æ–¥—É–∫—Ü—ñ—é
```python
def get_market_prices():
    """–û—Ç—Ä–∏–º—É—î –∞–∫—Ç—É–∞–ª—å–Ω—ñ —Ä–∏–Ω–∫–æ–≤—ñ —Ü—ñ–Ω–∏"""
    # –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –∞–≥—Ä–æ-–ø–æ—Ä—Ç–∞–ª–∞–º–∏
    return {
        'milk': 12.5,  # –≥—Ä–Ω/–ª
        'wheat': 8000,  # –≥—Ä–Ω/—Ç
    }
```

## –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∏ –í—ñ–¥–ø–æ–≤—ñ–¥–µ–π

Gemini –º–∞—î –ø–∞—Ä–∞–º–µ—Ç—Ä temperature (0.0 - 1.0):
- **0.0-0.3**: –¢–æ—á–Ω—ñ, –ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (–¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤)
- **0.4-0.7**: –ó–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)
- **0.8-1.0**: –ö—Ä–µ–∞—Ç–∏–≤–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (–¥–ª—è —ñ–¥–µ–π)

```python
generation_config = {
    'temperature': 0.7,
    'top_p': 0.95,
    'top_k': 40,
    'max_output_tokens': 2048,
}

response = model.generate_content(
    full_prompt,
    generation_config=generation_config
)
```

## –û–±–º–µ–∂–µ–Ω–Ω—è –¢–æ–∫–µ–Ω—ñ–≤

Gemini –º–∞—î –ª—ñ–º—ñ—Ç–∏ –Ω–∞ —Ç–æ–∫–µ–Ω–∏. –û–ø—Ç–∏–º—ñ–∑—É–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç:

```python
def optimize_context(context, max_length=4000):
    """–û–±—Ä—ñ–∑–∞—î –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó –¥–æ–≤–∂–∏–Ω–∏"""
    if len(context) > max_length:
        return context[:max_length] + "...(–∫–æ–Ω—Ç–µ–∫—Å—Ç –æ–±—Ä—ñ–∑–∞–Ω–æ)"
    return context
```

## –ö–µ—à—É–≤–∞–Ω–Ω—è –í—ñ–¥–ø–æ–≤—ñ–¥–µ–π

–î–ª—è –µ–∫–æ–Ω–æ–º—ñ—ó API –∑–∞–ø–∏—Ç—ñ–≤:

```python
from functools import lru_cache
import hashlib

@lru_cache(maxsize=100)
def get_cached_response(question_hash):
    """–ö–µ—à—É—î –ø–æ–ø—É–ª—è—Ä–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è"""
    pass

# –í chat():
question_hash = hashlib.md5(user_message.encode()).hexdigest()
cached = get_cached_response(question_hash)
```

## –ú—É–ª—å—Ç–∏–º–æ–≤–Ω—ñ—Å—Ç—å

–•–æ—á –±–∞–∑–∞ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é, –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–∫–ª–∞–¥:

```python
def detect_language(text):
    """–í–∏–∑–Ω–∞—á–∞—î –º–æ–≤—É —Ç–µ–∫—Å—Ç—É"""
    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ langdetect –∞–±–æ —ñ–Ω—à–µ
    pass

def translate_if_needed(text, target_lang='uk'):
    """–ü–µ—Ä–µ–∫–ª–∞–¥–∞—î –ø—Ä–∏ –ø–æ—Ç—Ä–µ–±—ñ"""
    pass
```

## –õ–æ–≥—É–≤–∞–Ω–Ω—è –í–∑–∞—î–º–æ–¥—ñ–π

–î–ª—è –∞–Ω–∞–ª—ñ–∑—É —è–∫–æ—Å—Ç—ñ:

```python
import logging

logging.basicConfig(
    filename='ai_interactions.log',
    level=logging.INFO,
    format='%(asctime)s - %(message)s'
)

# –í chat():
logging.info(f"User: {username} | Question: {user_message[:100]}")
logging.info(f"AI Response length: {len(ai_response)}")
```

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ü—Ä–æ–º–ø—Ç—ñ–≤

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ç–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç:

```python
# test_ai.py
test_questions = [
    "–°–∫—ñ–ª—å–∫–∏ –∫–æ—Ä—ñ–≤ –Ω–∞ —Ñ–µ—Ä–º—ñ?",
    "–Ø–∫–∞ —Å–µ—Ä–µ–¥–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å?",
    "–ü–æ—Ä–∞–¥—å —è–∫ –ø–æ–∫—Ä–∞—â–∏—Ç–∏ –Ω–∞–¥–æ—ó",
]

for q in test_questions:
    response = model.generate_content(get_ai_context() + "\n" + q)
    print(f"Q: {q}")
    print(f"A: {response.text}\n")
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó

1. **–ü–æ—á–∏–Ω–∞–π—Ç–µ –ø—Ä–æ—Å—Ç–æ** - –±–∞–∑–æ–≤–∏–π –ø—Ä–æ–º–ø—Ç, –ø–æ—Ç—ñ–º –ø–æ–∫—Ä–∞—â—É–π—Ç–µ
2. **–¢–µ—Å—Ç—É–π—Ç–µ –∑–º—ñ–Ω–∏** - –∫–æ–∂–Ω–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è –º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏ –ø–æ–≤–µ–¥—ñ–Ω–∫—É
3. **–ó–±–∏—Ä–∞–π—Ç–µ —Ñ—ñ–¥–±–µ–∫** - –∑–∞–ø–∏—Ç—É–π—Ç–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –ø—Ä–æ —è–∫—ñ—Å—Ç—å
4. **–ú–æ–Ω—ñ—Ç–æ—Ä—Ç–µ –≤–∏—Ç—Ä–∞—Ç–∏** - API –º–∞—î –ª—ñ–º—ñ—Ç–∏ —Ç–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å
5. **–û–Ω–æ–≤–ª—é–π—Ç–µ –ø–∞–º'—è—Ç—å** - —Ä–µ–≥—É–ª—è—Ä–Ω–æ –¥–æ–¥–∞–≤–∞–π—Ç–µ –Ω–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é

---

**–£—Å–ø—ñ—à–Ω–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –®–Ü! ü§ñ**
